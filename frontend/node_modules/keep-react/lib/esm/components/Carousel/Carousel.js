import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from"react/jsx-runtime";import{CaretLeft,CaretRight}from"phosphor-react";import{Children,cloneElement,useCallback,useEffect,useMemo,useRef,useState}from"react";import ScrollContainer from"react-indiana-drag-scroll";import{windowExists}from"../../helpers/window-exists";import{useTheme}from"../../Keep/ThemeContext";import{cn}from"../../helpers/cn";const Carousel=({children:e,indicators:t=!1,showControls:r=!1,leftControl:s,rightControl:a,slide:o=!0,slideInterval:l,indicatorsType:n="dot",indicatorsTypeColors:i="white",className:c,...d})=>{var u=windowExists()&&-1!==navigator.userAgent.indexOf("IEMobile");const m=useRef(null),[h,f]=useState(0),[p,C]=useState(!1),x=useTheme().theme.carousel,g=useMemo(()=>Children.map(e,e=>cloneElement(e,{className:cn(x.item.base,e.props.className)})),[e,x.item.base]),j=useCallback(e=>()=>{g&&(e=(e+g.length)%g.length,m.current&&(m.current.scrollLeft=m.current.clientWidth*e),f(e))},[g]);useEffect(()=>{m.current&&!p&&0!==m.current.scrollLeft&&f(Math.round(m.current.scrollLeft/m.current.clientWidth))},[p]),useEffect(()=>{if(o){const e=setInterval(()=>!p&&j(h+1)(),l??3e3);return()=>clearInterval(e)}},[h,p,j,o,l]);var _=e=>()=>C(e);return _jsxs("div",{className:cn(x.base,c),"data-testid":"carousel",...d,children:[_jsx(ScrollContainer,{className:cn(x.scrollContainer.base,(u||!p)&&x.scrollContainer.snap),draggingClassName:"cursor-grab",innerRef:m,onEndScroll:_(!1),onStartScroll:_(!0),vertical:!1,children:g?.map((e,t)=>_jsx("div",{className:x.item.wrapper,"data-active":h===t,"data-testid":"carousel-item",children:e},t))}),t&&_jsx("div",{className:x.indicators.wrapper,children:g?.map((e,t)=>_jsx("button",{className:cn(x.indicators.base,x.indicators.type[n],t===h&&x.indicators.active.on.type[n],t===h&&x.indicators.active.on.color[i],t!==h&&x.indicators.active.off.color[i]),onClick:j(t),"data-testid":"carousel-indicator"},t))}),g&&r&&_jsxs(_Fragment,{children:[_jsx("div",{className:x.leftControl,children:_jsx("button",{className:"group","data-testid":"carousel-left-control",onClick:j(h-1),type:"button",children:s||_jsx(DefaultLeftControl,{})})}),_jsx("div",{className:x.rightControl,children:_jsx("button",{className:"group","data-testid":"carousel-right-control",onClick:j(h+1),type:"button",children:a||_jsx(DefaultRightControl,{})})})]})]})},DefaultLeftControl=()=>{var e=useTheme().theme.carousel;return _jsx("span",{className:e.control.base,children:_jsx(CaretLeft,{size:20,weight:"bold",color:"white"})})},DefaultRightControl=()=>{var e=useTheme().theme.carousel;return _jsx("span",{className:e.control.base,children:_jsx(CaretRight,{size:20,weight:"bold",color:"white"})})};export{Carousel};