import{jsx as _jsx,jsxs as _jsxs}from"react/jsx-runtime";import{CaretDown,CaretLeft,CaretRight,CaretUp}from"phosphor-react";import React,{Children,useCallback,useEffect,useMemo,useRef,useState}from"react";import{uuid}from"../../helpers/uuid";import{useTheme}from"../../Keep/ThemeContext";import{Button}from"../Button/Button";import{Floating}from"../Floating";import{DropdownDivider}from"./DropdownDivider";import{DropdownHeader}from"./DropdownHeader";import{DropdownItem}from"./DropdownItem";const icons={top:_jsx(CaretUp,{size:18}),right:_jsx(CaretRight,{size:18}),bottom:_jsx(CaretDown,{size:18}),left:_jsx(CaretLeft,{size:18})},DropdownComponent=({children:e,dismissOnClick:o=!0,...t})=>{const r=useTheme().theme.dropdown;const{placement:n="bottom-start",trigger:i="click",label:s,floatingArrow:a=!1,arrowIcon:d=!0,...p}=t;t=useMemo(()=>{var[e]=n.split("-");return icons[e]??_jsx(CaretDown,{size:18})},[n]);const[m,l]=useState(void 0);var[c,u]=useState(void 0);const D=useCallback(e=>React.isValidElement(e)?e.type===DropdownItem?React.cloneElement(e,{onClick:()=>{e.props.onClick?.(),o&&l(uuid())}}):e.props.children&&"object"==typeof e.props.children?React.cloneElement(e,{children:Children.map(e.props.children,D)}):e:e,[o]);var h=useMemo(()=>_jsx("ul",{className:r.content,children:Children.map(e,D)}),[D,e,r.content]);return _jsx(Floating,{content:h,style:"auto",animation:"duration-100",placement:n,arrow:a,trigger:i,theme:r.floating,minWidth:c,closeRequestKey:m,children:_jsxs(({children:e,setButtonWidth:o})=>{const t=useRef(null);return useEffect(()=>{t.current&&o?.(t.current.clientWidth)},[t,o]),_jsx(Button,{...p,ref:t,children:e})},{setButtonWidth:u,children:[s,_jsx("span",{className:"ml-1",children:d&&t})]})})},Dropdown=(DropdownComponent.displayName="Dropdown",DropdownItem.displayName="Dropdown.Item",DropdownHeader.displayName="Dropdown.Header",DropdownDivider.displayName="Dropdown.Divider",Object.assign(DropdownComponent,{Item:DropdownItem,Header:DropdownHeader,Divider:DropdownDivider}));export{Dropdown};